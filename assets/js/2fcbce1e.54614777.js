"use strict";(self.webpackChunkgithub_pages_docusaurus_template=self.webpackChunkgithub_pages_docusaurus_template||[]).push([[8234],{3905:function(t,e,a){a.d(e,{Zo:function(){return m},kt:function(){return c}});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var s=n.createContext({}),p=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):l(l({},e),t)),a},m=function(t){var e=p(t.components);return n.createElement(s.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,s=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),d=p(a),c=r,h=d["".concat(s,".").concat(c)]||d[c]||u[c]||i;return a?n.createElement(h,l(l({ref:e},m),{},{components:a})):n.createElement(h,l({ref:e},m))}));function c(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,l=new Array(i);l[0]=d;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=t,o.mdxType="string"==typeof t?t:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},61105:function(t,e,a){a.r(e),a.d(e,{assets:function(){return m},contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return u}});var n=a(87462),r=a(63366),i=(a(67294),a(3905)),l=["components"],o={sidebar_position:3},s="Security Assessment",p={unversionedId:"threat-modeling/security-assessment",id:"threat-modeling/security-assessment",title:"Security Assessment",description:"The security assessment describes a detailed detailed threat modeling process.",source:"@site/docs/threat-modeling/security-assessment.md",sourceDirName:"threat-modeling",slug:"/threat-modeling/security-assessment",permalink:"/personal-website/docs/threat-modeling/security-assessment",editUrl:"https://github.com/the-tatanka/personal-website/blob/master/docs/threat-modeling/security-assessment.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"projectsSidebar",previous:{title:"Rules of thumb",permalink:"/personal-website/docs/threat-modeling/rules-of-thumb"},next:{title:"Checklist",permalink:"/personal-website/docs/threat-modeling/checklist"}},m={},u=[{value:"Writing a good diagram",id:"writing-a-good-diagram",level:2},{value:"STRIDE",id:"stride",level:2},{value:"STRIDE-per-element",id:"stride-per-element",level:2},{value:"Risk analysis",id:"risk-analysis",level:2},{value:"Risk treatment",id:"risk-treatment",level:2},{value:"Risk treatment plan",id:"risk-treatment-plan",level:3}],d={toc:u};function c(t){var e=t.components,a=(0,r.Z)(t,l);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"security-assessment"},"Security Assessment"),(0,i.kt)("p",null,"The security assessment describes a detailed ",(0,i.kt)("b",null,"detailed")," threat modeling process."),(0,i.kt)("h2",{id:"writing-a-good-diagram"},"Writing a good diagram"),(0,i.kt)("p",null,"Having a good diagram is key to a good threat model."),(0,i.kt)("p",null,"The first step is to draw a whiteboard diagram of the flow of data in your component. It's the DATA flow you care about, NOT the code flow. Your threats come via data, NOT code."),(0,i.kt)("p",null,"Use the following elements:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"External Interactor: Is an element that is outside your area of control. It could be a user calling into an API, it could be another component (browser, user) but not one that's being threat modeled.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Process: A process is simply some code (or microservice). It does NOT mean that it's a \"process\" as OS's call processes, instead it's just a collection of code.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Data Store: A datastore is something that holds data.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Data Flow: Represents the flow of data through the system.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Trust Boundary: Occurs when one component doesn't trust the component on the other side of the boundary. There is always a trust boundary between elements running at different privilege levels.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("i",null,"Data"),": Could be a file, a registry key or personal data. This element does not appear in the classic data flow diagram. However, I find it helpful to explicitly model certain security relevant data.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Data Stores store data"),(0,i.kt)("li",{parentName:"ul"},"Processes process data."),(0,i.kt)("li",{parentName:"ul"},"Data Flows send Data.")))),(0,i.kt)("h2",{id:"stride"},"STRIDE"),(0,i.kt)("p",null,'STRIDE stands for "Spoofing", "Tampering", "Repudiation", "Information disclosure", "Denial of service", and "Elevation of privilege".'),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Threat"),(0,i.kt)("th",{parentName:"tr",align:null},"Property"),(0,i.kt)("th",{parentName:"tr",align:null},"Definition"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Spoofing"),(0,i.kt)("td",{parentName:"tr",align:null},"Authentication"),(0,i.kt)("td",{parentName:"tr",align:null},"Impersonating something or someone else")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Tampering"),(0,i.kt)("td",{parentName:"tr",align:null},"Integrity"),(0,i.kt)("td",{parentName:"tr",align:null},"Modifying data or code")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Repudiation"),(0,i.kt)("td",{parentName:"tr",align:null},"Non-repudiation"),(0,i.kt)("td",{parentName:"tr",align:null},"Claiming to have not performed an action")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Information Disclosure"),(0,i.kt)("td",{parentName:"tr",align:null},"Confidentiality"),(0,i.kt)("td",{parentName:"tr",align:null},"Exposing information to someone not authorized to see it")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Denial of Service"),(0,i.kt)("td",{parentName:"tr",align:null},"Availability"),(0,i.kt)("td",{parentName:"tr",align:null},"Deny or degrade service to users")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Elevation of Privilege"),(0,i.kt)("td",{parentName:"tr",align:null},"Authorization"),(0,i.kt)("td",{parentName:"tr",align:null},"Gain capabilities without proper authorization")))),(0,i.kt)("p",null,"Essentially the idea is that you can classify all your threats according to one of the 6 STRIDE categories. But STRIDE is not a rigorous classification mechanism - there's a ton of overlap between the various categories (a successful Elevation of Privilege attack could result in Tampering of data, for instance). But it doesn't change the fact that it's an extremely useful mechanism for analyzing threats to a system."),(0,i.kt)("p",null,"It turns out that some STRIDE threats only apply to particular types of elements. If you think about it, it makes sense - for instance, an Elevation of Privilege threat doesn't apply to data stores (since a data store simply holds data, it operates at no privilege level)."),(0,i.kt)("p",null,"For each element type, the following threats are considered valid:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Element type"),(0,i.kt)("th",{parentName:"tr",align:null},"S"),(0,i.kt)("th",{parentName:"tr",align:null},"T"),(0,i.kt)("th",{parentName:"tr",align:null},"R"),(0,i.kt)("th",{parentName:"tr",align:null},"I"),(0,i.kt)("th",{parentName:"tr",align:null},"D"),(0,i.kt)("th",{parentName:"tr",align:null},"E"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"External Entities"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Processes"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Data Stores"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"?"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Data Flows"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Data"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null},"X"),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"?: Data stores often come under attack to allow for a repudiation attack to work (if you have a log located in a data store, the attacker might try to flood the data store with log entries to enable a repudiation attack. In addition, logs held in data stores are almost always the mitigation against a repudiation threat.")),(0,i.kt)("h2",{id:"stride-per-element"},"STRIDE-per-element"),(0,i.kt)("p",null,'We call this process of considering the element-specific threats to each element in the DFD "STRIDE-per-Element".'),(0,i.kt)("p",null,"And the best part about it is that STRIDE/element allows people to produce competent threat models with relatively little training."),(0,i.kt)("p",null,"The STRIDE-per-element methodology ends up creating a fair number of threats, even a component with a relatively tiny diagram. The good news is that many/most of those threats aren't meaningful threats."),(0,i.kt)("p",null,"This analysis is the core of the threat model, and where the real work associated with the process takes place."),(0,i.kt)("h2",{id:"risk-analysis"},"Risk analysis"),(0,i.kt)("p",null,"For each threat, the risk must be determined. The defined risk assessment methodology can be used for this purpose."),(0,i.kt)("h2",{id:"risk-treatment"},"Risk treatment"),(0,i.kt)("p",null,"For each risk, the risk treatment option must be determined."),(0,i.kt)("p",null,"Risk treatment options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Avoid - deciding not to proceed with the activity that introduced the unacceptable risk, choosing an alternative more acceptable activity that meets business objectives, or choosing an alternative less risky approach or process.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Reduce - implementing a strategy that is designed to reduce the likelihood or consequence of the risk to an acceptable level, where elimination is considered to be excessive in terms of time or expense.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Transfer - implementing a strategy that shares or transfers the risk to another party or parties, such as outsourcing the management of physical assets, developing contracts with service providers or insuring against the risk. The third-party accepting the risk should be aware of and agree to accept this obligation.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Accept - making an informed decision that the risk rating is at an acceptable level or that the cost of the treatment outweighs the benefit. This option may also be relevant in situations where a residual risk remains after other treatment options have been put in place. No further action is taken to treat the risk, however, ongoing monitoring is recommended."))),(0,i.kt)("p",null,"In an ideal world, a risk treatment plan can be created. Unfortunately, this is usually unrealistic and creates more overhead than benefit."),(0,i.kt)("p",null,'What cannot be waived, however, is for each risk with the treatment option "reduce", to create issues / stories for the associated mitigations and to include the issue number in the security assessment report.'),(0,i.kt)("p",null,"This ensures that the mitigations are in the backlog and are visible to the development team."),(0,i.kt)("h3",{id:"risk-treatment-plan"},"Risk treatment plan"),(0,i.kt)("p",null,"Effective risk treatment relies on attaining commitment from key practice stakeholders and developing realistic objectives and timelines for implementation."),(0,i.kt)("p",null,"For each risk identified in the risk assessment, detail the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Specify the treatment option agreed - avoid, reduce, share/transfer or accept.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Document the treatment plan - outline the approach to be used to treat the risk. Any relationships or interdependencies with other risks should also be highlighted.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Assign an appropriate owner - who is accountable for monitoring and reporting on progress of the treatment plan implementation. Where the treatment plan owner and the risk owner are different, the risk owner has ultimate accountability for ensuring the agreed treatment plan is implemented.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Specify a target resolution date - where risk treatments have long lead times, consider the development of interim measures. For example, it is unlikely to be acceptable for a residual risk to be rated \u2018high' and to have a risk treatment with a resolution timeframe of two years."))))}c.isMDXComponent=!0}}]);